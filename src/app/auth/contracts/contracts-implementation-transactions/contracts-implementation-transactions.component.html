<div class="content">
  <div class="container">
    <div class="row mt-3">
      <div class="col">
        <!-- <p>
          Una lista de transacciones de pago realizadas contra este contrato.
        </p> -->
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="table-responsive-sm">
          <table class="table table-hover table-striped mb-10">
            <thead>
              <tr>
                <th scope="col">ID</th>
                <th scope="col">Fecha de transacción</th>
                <th scope="col">Método de pago</th>
                <th scope="col">Monto</th>
                <th scope="col">Moneda</th>
                <th scope="col">
                  Emisor <br />
                  del <br />
                  pago
                </th>
                <th scope="col">
                  Receptor <br />
                  del pago <br />
                </th>
                <th scope="col">Opciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let transaction of transactionsArray; let i = index">
                <td>{{ transaction.id || i + 1 }}</td>
                <td>{{ transaction.date }}</td>
                <td>{{ transaction.paymentMethod }}</td>
                <td>{{ transaction.value.amount }}</td>
                <td>{{ transaction.value.currency }}</td>
                <td>{{ transaction.payer?.name }}</td>
                <td>{{ transaction.payee?.name }}</td>
                <td>
                  <button
                    type="button"
                    class="btn btn-danger btn-delete"
                    (click)="deleteTransaction.emit(i)"
                  >
                    Eliminar
                  </button>
                </td>
              </tr>
              <tr *ngIf="transactionsArray.length === 0">
                <th scope="row" colspan="8" class="text-center">
                  Sin registros.
                </th>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <form [formGroup]="transactionsForm">
      <div class="row">
        <div class="form-floating col mb-2">
          <input
            type="date"
            class="form-control"
            id="TransacctionsDate"
            placeholder="Fecha de la transacción"
            formControlName="date"
          />
          <label for="TransacctionsDate" class="form-label"
            >Fecha de la transacción</label
          >
        </div>
      </div>
      <div class="row">
        <div class="form-floating col mb-2">
          <input
            type="text"
            class="form-control"
            id="TransactionsSource"
            placeholder="Fuente de datos"
            formControlName="source"
          />
          <label for="TransactionsSource" class="form-label"
            >Fuente de datos</label
          >
        </div>
        <div class="form-floating col mb-3">
          <select class="form-select" formControlName="paymentMethod">
            <option
              *ngFor="let method of paymentMethods"
              [ngValue]="method.code"
            >
              {{ method.title }}
            </option>
          </select>
          <label for="TransactionsPaymentMethod">Método de Pago</label>
          <p class="mt-2">
            {{ getPaymentMethodDesc(transactionsForm.value.paymentMethod) }}
          </p>
        </div>
      </div>

      <fieldset class="border p-3 mb-3">
        <legend class="w-auto px-2">Valor</legend>
        <div class="row" formGroupName="value">
          <div class="form-floating col-md-6">
            <input
              type="number"
              class="form-control"
              id="TransactionsValueAmount"
              placeholder="Monto de la transacción"
              formControlName="amount"
            />
            <label for="TransactionsValueAmount">Monto</label>
          </div>

          <div class="form-floating form-group col-md-6">
            <select
              class="form-select"
              aria-label="moneda"
              formControlName="currency"
            >
              <option *ngFor="let c of currency" [ngValue]="c.code">
                {{ c.title }}
              </option>
            </select>
            <label for="TransactionsValueCurrency">Moneda</label>
          </div>
        </div>
      </fieldset>

      <div class="row">
        <div class="form-floating col mb-2">
          <select class="form-select" formControlName="payer">
            <option *ngFor="let p of payers" [ngValue]="p">
              {{ p?.name }}
            </option>
          </select>
          <label for="">Emisor del pago</label>
        </div>
        <div class="form-text">
          Persona encargado por la Entidad o Institución pública de dar
          cumplimiento al pago de la adquisición, arrendamiento, servicio u obra
          contratados.
        </div>
      </div>

      <div class="row">
        <div class="form-floating col mb-2">
          <select class="form-select" formControlName="payee">
            <option *ngFor="let b of payee" [ngValue]="b">
              {{ b?.name }}
            </option>
          </select>
          <label for="">Receptor del pago</label>
        </div>
        <div class="form-text">
          Es una persona física o moral la cual recibe un pago económico
          derivado de un contrato (transacción).
        </div>
      </div>

      <div class="row">
        <div class="form-floating col mb-2">
          <input
            type="text"
            class="form-control"
            id="TransactionsUri"
            placeholder="URI"
            formControlName="uri"
          />
          <label for="TransactionsUri">URI</label>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <button
            type="button"
            class="btn btn-danger btn-add"
            (click)="addNewTransactions()"
          >
            Agregar transacción
          </button>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-12 spin">
          <div *ngIf="mostrarSpinner" class="spinner-container">
            <div class="spinner-border" role="status">
              <span class="visually-hidden">Guardando...</span>
            </div>
            <p class="mt-2">Guardando...</p>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
